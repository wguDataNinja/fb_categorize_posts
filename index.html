<!doctype html>
<meta charset="utf-8">
<title>FB WGU Accelerators Prototype – Datasette Lite</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body{font:16px system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0}
  header{padding:24px}
  h1{margin:0 0 4px 0;font-size:20px}
  .sub{margin:0 0 8px 0;font-size:13px;color:#666}
  main{display:grid;grid-template-columns:280px 1fr;gap:16px;padding:0 24px 24px}
  nav a{display:block;margin:6px 0;text-decoration:none}
  nav a:hover,nav a:focus{text-decoration:underline}
  iframe{width:100%;height:78vh;border:1px solid #ddd;border-radius:8px}
  @media (max-width:900px){main{grid-template-columns:1fr} nav{order:2}}
</style>

<header>
  <h1>FB WGU Accelerators Prototype</h1>
  <p class="sub">216 posts from 9/1 to 9/14 2025</p>
</header>

<main>
  <nav id="links"></nav>
  <iframe name="ds" id="ds"></iframe>
</main>

<script>
  const CSV   = "https://wgudataninja.github.io/fb_categorize_posts/data/fb_accelerators_sep1-14_sentiment.csv";
  const TABLE = "fb_accelerators_sep1-14_sentiment";
  const DB    = "data";

  const categories = [
    "celebrations_milestones",
    "course_help",
    "admin_mentor",
    "tech_platforms",
    "financial_aid_policy",
    "general_experiences",
    "motivation_fun",
    "career_jobs_networking",
    "other"
  ];

  const BASE  = `https://lite.datasette.io/?csv=${encodeURIComponent(CSV)}`;
  const sqlURL = (sql) => `${BASE}#${DB}?sql=${encodeURIComponent(sql)}&_size=max`;

  // All posts → table view (sortable + facets)
  const allURL = `${BASE}#data/${encodeURIComponent(TABLE)}?_facet=category`;

  // LLM-friendly: only category + text, sorted by category
  const llmURL = sqlURL(`
    select category, text
    from [${TABLE}]
    order by category, text
  `);

  // Category-specific SQL views (hide rationale, drop link/rowid)
  const catURL = (c) => sqlURL(`
    select user_id, category, confidence, sentiment_compound, text
    from [${TABLE}]
    where category = ${JSON.stringify(c)}
  `);

  const items = [
    ["All posts (sortable table with facets)", allURL],
    ["LLM-Friendly (category, text)", llmURL],
    ...categories.map(c => [`Category: ${c}`, catURL(c)])
  ];

  const nav = document.getElementById("links");
  nav.innerHTML = items.map(([label, href]) => `<a href="${href}" target="ds">${label}</a>`).join("");
  document.getElementById("ds").src = items[0][1];
</script>